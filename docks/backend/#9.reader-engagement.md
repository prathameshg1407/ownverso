

# Reader Engagement – Technical Documentation

## 1. Purpose & Scope

The **Reader Engagement** module covers:

- **Reading progress tracking**:
  - Per-series position (last chapter, completion percentage, time spent)
  - Sync across devices

- **Bookmarks**:
  - In-chapter bookmarks with notes and highlighted text

- **Reading lists**:
  - Custom lists (Want to Read, Reading, Completed, Favorites, custom)
  - Public/private lists
  - Following others’ lists

- **Reader settings**:
  - Typography, layout, theme, behavior, comic reading preferences
  - Email digest frequency

- **Reader engagement scores**:
  - Per-user/per-series engagement metrics (read time, interactions, visits)
  - Used for analytics/recommendations (mostly read-only from APIs)

This module is **reader-centric**, but authors can see aggregated engagement views of their series (detailed author analytics documented in Analytics category).

---

## 2. Prisma Schema (Models & Enums)

### 2.1 Relevant Enums

From the global schema; repeated for clarity.

```prisma
enum ReadingTheme {
  LIGHT
  DARK
  SEPIA
  AMOLED
  SYSTEM
  CUSTOM
}

enum PageWidth {
  NARROW
  MEDIUM
  WIDE
  FULL
}

enum TextAlignment {
  LEFT
  JUSTIFY
  CENTER
  RIGHT
}

enum ComicReadingMode {
  VERTICAL_SCROLL
  PAGINATED
  LONG_STRIP
  DOUBLE_PAGE
}
```

### 2.2 Models

#### 2.2.1 `ReadingProgress`

Tracks a reader’s progress within a series (and optionally last chapter location).

```prisma
model ReadingProgress {
  id        String @id @default(cuid())
  userId    BigInt
  seriesId  String
  chapterId String?

  lastChapterNumber Float @default(0)
  progressPercent   Float @default(0)
  scrollPosition    Int?
  pagePosition      Int?    @db.SmallInt
  paragraphIndex    Int?    @db.SmallInt

  totalReadTimeSeconds  Int       @default(0)
  currentSessionStart   DateTime?
  currentSessionSeconds Int       @default(0)

  chaptersCompleted Int       @default(0)
  isSeriesComplete  Boolean   @default(false)
  seriesCompletedAt DateTime?

  firstReadAt DateTime @default(now())
  lastReadAt  DateTime @default(now())

  deviceId   String?
  deviceType DeviceType?
  deviceName String?
  syncedAt   DateTime @default(now())

  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  user    User     @relation(fields: [userId], references: [id], onDelete: Cascade)
  series  Series   @relation(fields: [seriesId], references: [id], onDelete: Cascade)
  chapter Chapter? @relation(fields: [chapterId], references: [id], onDelete: SetNull)

  @@unique([userId, seriesId])
  @@index([userId, lastReadAt(sort: Desc)])
  @@index([seriesId])

  @@map("reading_progress")
}
```

#### 2.2.2 `Bookmark`

```prisma
model Bookmark {
  id        String @id @default(cuid())
  userId    BigInt
  seriesId  String
  chapterId String

  position     Int?
  selectedText String? @db.Text
  note         String? @db.Text
  color        String? @db.Char(7)

  createdAt DateTime  @default(now())
  updatedAt DateTime  @updatedAt
  deletedAt DateTime?

  user    User    @relation(fields: [userId], references: [id], onDelete: Cascade)
  series  Series  @relation(fields: [seriesId], references: [id], onDelete: Cascade)
  chapter Chapter @relation(fields: [chapterId], references: [id], onDelete: Cascade)

  @@unique([userId, chapterId, position])
  @@index([userId, seriesId])
  @@index([deletedAt])

  @@map("bookmarks")
}
```

#### 2.2.3 `ReadingList`

```prisma
enum ReadingListType {
  WANT_TO_READ
  CURRENTLY_READING
  COMPLETED
  ON_HOLD
  DROPPED
  FAVORITES
  REREADING
  CUSTOM
}

model ReadingList {
  id     String @id @default(cuid())
  userId BigInt

  name        String          @db.VarChar(100)
  slug        String
  description String?         @db.Text
  coverUrl    String?         @db.VarChar(2048)
  listType    ReadingListType @default(CUSTOM)

  isPublic  Boolean @default(false)
  isDefault Boolean @default(false)

  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  user      User                @relation(fields: [userId], references: [id], onDelete: Cascade)
  items     ReadingListItem[]
  followers ReadingListFollow[]

  @@unique([userId, slug])
  @@index([userId, listType])
  @@index([isPublic])

  @@map("reading_lists")
}
```

#### 2.2.4 `ReadingListItem`

```prisma
model ReadingListItem {
  readingListId String
  seriesId      String

  order      Int     @default(0) @db.SmallInt
  notes      String? @db.Text
  userRating Int?    @db.SmallInt // 1–10

  addedAt DateTime @default(now())

  readingList ReadingList @relation(fields: [readingListId], references: [id], onDelete: Cascade)
  series      Series      @relation(fields: [seriesId], references: [id], onDelete: Cascade)

  @@id([readingListId, seriesId])
  @@index([seriesId])

  @@map("reading_list_items")
}
```

#### 2.2.5 `ReadingListFollow`

```prisma
model ReadingListFollow {
  readingListId String
  userId        BigInt

  createdAt DateTime @default(now())

  readingList ReadingList @relation(fields: [readingListId], references: [id], onDelete: Cascade)
  user        User        @relation(fields: [userId], references: [id], onDelete: Cascade)

  @@id([readingListId, userId])
  @@index([userId])

  @@map("reading_list_follows")
}
```

#### 2.2.6 `ReaderSettings`

```prisma
model ReaderSettings {
  id     BigInt @id @default(autoincrement())
  userId BigInt @unique

  // Typography
  fontFamily       String @default("system")
  fontSize         Int    @default(18) @db.SmallInt
  lineHeight       Float  @default(1.8)
  letterSpacing    Float  @default(0)
  paragraphSpacing Float  @default(1)

  // Layout
  pageWidth PageWidth     @default(MEDIUM)
  textAlign TextAlignment @default(LEFT)

  // Theme
  theme        ReadingTheme @default(SYSTEM)
  customColors Json?

  // Behavior
  autoBookmark      Boolean @default(true)
  showProgress      Boolean @default(true)
  showReadingTime   Boolean @default(true)
  enableSwipeNav    Boolean @default(true)
  enableKeyboardNav Boolean @default(true)
  enableScrollSync  Boolean @default(true)

  // Auto-scroll
  autoScrollEnabled Boolean @default(false)
  autoScrollSpeed   Int     @default(50) @db.SmallInt

  // Accessibility
  reducedMotion Boolean @default(false)
  dyslexicFont  Boolean @default(false)
  highContrast  Boolean @default(false)

  // Comic/Webtoon
  comicReadingMode ComicReadingMode @default(VERTICAL_SCROLL)
  comicZoomLevel   Float            @default(1.0)
  comicPageGap     Int              @default(0) @db.SmallInt

  // Notifications (some overlap with UserPreferences)
  chapterNotifications Boolean              @default(true)
  emailDigest          EmailDigestFrequency @default(INSTANT)

  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  user User @relation(fields: [userId], references: [id], onDelete: Cascade)

  @@map("reader_settings")
}
```

#### 2.2.7 `ReaderEngagementScore`

```prisma
model ReaderEngagementScore {
  userId   BigInt
  seriesId String

  engagementScore Float @default(0)

  // Component scores
  readingScore     Float @default(0)
  interactionScore Float @default(0)
  loyaltyScore     Float @default(0)
  advocacyScore    Float @default(0)

  // Reading metrics
  chaptersRead       Int   @default(0)
  totalChapters      Int   @default(0)
  completionPercent  Float @default(0)
  avgReadTimeSeconds Int   @default(0)
  totalReadSeconds   Int   @default(0)

  // Interaction metrics
  commentsCount  Int @default(0)
  reactionsCount Int @default(0)
  reviewsCount   Int @default(0)
  sharesCount    Int @default(0)

  // Visit patterns
  visitCount           Int       @default(0)
  avgDaysBetweenVisits Float     @default(0)
  lastVisitAt          DateTime?
  streakDays           Int       @default(0) @db.SmallInt
  longestStreak        Int       @default(0) @db.SmallInt

  // Subscription
  isSubscribed       Boolean @default(false)
  subscriptionTier   String?
  subscriptionMonths Int     @default(0) @db.SmallInt
  lifetimeValue      Int     @default(0)

  calculatedAt DateTime @default(now())
  updatedAt    DateTime @updatedAt

  user   User   @relation(fields: [userId], references: [id], onDelete: Cascade)
  series Series @relation(fields: [seriesId], references: [id], onDelete: Cascade)

  @@id([userId, seriesId])
  @@index([seriesId])
  @@index([engagementScore(sort: Desc)])

  @@map("reader_engagement_scores")
}
```

---

## 3. Backend Implementation

### 3.1 Route & Handler Structure

We group into **reading**, **bookmarks**, **reading-lists**, **settings**, **engagement**.

#### 3.1.1 Reading Progress – `src/api/v1/reading/`

```text
src/api/v1/reading/
  index.ts
  reading.controller.ts
  reading.service.ts
  reading.schema.ts
  reading.test.ts

  handlers/
    progress/
      list-progress.handler.ts          # GET /reading/progress
      get-progress.handler.ts           # GET /reading/progress/{seriesId}
      update-progress.handler.ts        # PUT /reading/progress/{seriesId}
      clear-progress.handler.ts         # DELETE /reading/progress/{seriesId}
      sync-progress.handler.ts          # POST /reading/progress/sync
      get-continue-reading.handler.ts   # GET /reading/continue

    history/
      get-history.handler.ts            # GET /reading/history
      clear-history.handler.ts          # DELETE /reading/history
      remove-from-history.handler.ts    # DELETE /reading/history/{seriesId}
```

#### 3.1.2 Bookmarks – `src/api/v1/bookmarks/`

```text
src/api/v1/bookmarks/
  index.ts
  bookmarks.controller.ts
  bookmarks.service.ts
  bookmarks.schema.ts
  bookmarks.test.ts

  handlers/
    list-bookmarks.handler.ts           # GET /bookmarks
    list-series-bookmarks.handler.ts    # GET /bookmarks/series/{seriesId}
    create-bookmark.handler.ts          # POST /bookmarks
    update-bookmark.handler.ts          # PUT /bookmarks/{id}
    delete-bookmark.handler.ts          # DELETE /bookmarks/{id}
```

#### 3.1.3 Reading Lists – `src/api/v1/reading-lists/`

```text
src/api/v1/reading-lists/
  index.ts
  reading-lists.controller.ts
  reading-lists.service.ts
  reading-lists.schema.ts
  reading-lists.test.ts

  handlers/
    list-reading-lists.handler.ts       # GET /reading-lists
    create-reading-list.handler.ts      # POST /reading-lists
    get-reading-list.handler.ts         # GET /reading-lists/{id}
    update-reading-list.handler.ts      # PUT /reading-lists/{id}
    delete-reading-list.handler.ts      # DELETE /reading-lists/{id}

    items/
      add-to-list.handler.ts            # POST /reading-lists/{id}/items
      remove-from-list.handler.ts       # DELETE /reading-lists/{id}/items/{seriesId}
      reorder-list.handler.ts           # PUT /reading-lists/{id}/items/reorder

    follows/
      follow-list.handler.ts            # POST /reading-lists/{id}/follow
      unfollow-list.handler.ts          # DELETE /reading-lists/{id}/follow
      list-followers.handler.ts         # GET /reading-lists/{id}/followers

    public/
      get-public-list.handler.ts        # GET /lists/{username}/{slug} (public)
      list-user-public-lists.handler.ts # GET /lists/{username}
```

#### 3.1.4 Reader Settings – `src/api/v1/reader-settings/`

```text
src/api/v1/reader-settings/
  index.ts
  reader-settings.controller.ts
  reader-settings.service.ts
  reader-settings.schema.ts
  reader-settings.test.ts

  handlers/
    get-settings.handler.ts             # GET /reader/settings
    update-settings.handler.ts          # PUT /reader/settings
    update-typography.handler.ts        # PUT /reader/settings/typography
    update-theme.handler.ts             # PUT /reader/settings/theme
    update-behavior.handler.ts          # PUT /reader/settings/behavior
    update-comic.handler.ts             # PUT /reader/settings/comic
    reset-settings.handler.ts           # POST /reader/settings/reset
```

#### 3.1.5 Engagement Scores (read-only) – `src/api/v1/engagement/`

```text
src/api/v1/engagement/
  index.ts
  engagement.controller.ts
  engagement.service.ts
  engagement.schema.ts
  engagement.test.ts

  handlers/
    reader/
      list-my-engagement.handler.ts     # GET /engagement
      get-my-engagement-for-series.handler.ts # GET /engagement/series/{seriesId}

    author/
      list-series-engagement.handler.ts # GET /author/series/{seriesId}/engagement
      list-top-engaged-readers.handler.ts # GET /author/series/{seriesId}/engaged-readers
```

> Note: Detailed analytics belongs in the Analytics module, but basic engagement views fit here for readers/authors.

### 3.2 Domain Layer

**Reading:** `src/domain/reading/`

```text
src/domain/reading/
  entities/
    reading-progress.entity.ts
    bookmark.entity.ts
    reading-list.entity.ts
    reading-list-item.entity.ts
    reading-list-follow.entity.ts
    reader-settings.entity.ts
    reader-engagement-score.entity.ts

  repositories/
    reading-progress.repository.ts
    bookmark.repository.ts
    reading-list.repository.ts
    reading-list-item.repository.ts
    reading-list-follow.repository.ts
    reader-settings.repository.ts
    reader-engagement-score.repository.ts

  services/
    reading-progress.service.ts      # update, sync, continue reading
    bookmark.service.ts
    reading-list.service.ts
    reader-settings.service.ts
    engagement-score.service.ts      # calculates or fetches scores
```

---

## 4. Frontend Implementation (Next.js)

### 4.1 Reader Dashboard – Library & History

Routes under `src/app/(reader-dashboard)/library/`:

```text
src/app/(reader-dashboard)/library/
  page.tsx                             # /library – overview (continue reading, lists)
  continue-reading/
    page.tsx                           # /library/continue
  history/
    page.tsx                           # /library/history

  _components/
    library-tabs.tsx
    continue-reading-card.tsx
    continue-reading-list.tsx
    reading-history-list.tsx
    reading-history-item.tsx
```

### 4.2 Bookmarks

Routes under `src/app/(reader-dashboard)/bookmarks/`:

```text
src/app/(reader-dashboard)/bookmarks/
  page.tsx                             # /bookmarks – all bookmarks
  [seriesId]/
    page.tsx                           # /bookmarks/{seriesId} – bookmarks for a specific series

  _components/
    bookmark-list.tsx
    bookmark-item.tsx
    bookmark-filter.tsx
```

### 4.3 Reading Lists

Routes under `src/app/(reader-dashboard)/reading-lists/`:

```text
src/app/(reader-dashboard)/reading-lists/
  page.tsx                             # /reading-lists – my lists
  create/
    page.tsx
  [listId]/
    page.tsx                           # /reading-lists/{id}
    edit/
      page.tsx

  _components/
    reading-list-card.tsx
    reading-list-grid.tsx
    reading-list-form.tsx
    reading-list-items.tsx
    reading-list-item-card.tsx
    reading-list-follow-button.tsx
    public-list-share.tsx
```

Public reading lists (viewing others’ lists) under `src/app/(reader)/lists/[username]/[slug]/`:

```text
src/app/(reader)/lists/[username]/
  page.tsx                             # lists by user
  [slug]/
    page.tsx                           # public list detail
```

### 4.4 Reader Settings

Routes under `src/app/(reader-dashboard)/settings/reading/`:

```text
src/app/(reader-dashboard)/settings/reading/
  page.tsx                             # /settings/reading
  _components/
    reading-settings-form.tsx
    typography-settings.tsx
    layout-settings.tsx
    theme-settings.tsx
    behavior-settings.tsx
    comic-settings.tsx
```

### 4.5 Components in Reader UI

```text
src/components/reader/
  reader-layout.tsx
  reader-toolbar.tsx
  reader-progress-bar.tsx
  reader-settings-drawer.tsx
  bookmark-button.tsx
  bookmark-panel.tsx
  reading-progress-indicator.tsx
  auto-scroll-controls.tsx
  theme-switcher.tsx
```

---

## 5. Hooks & Frontend API Clients

### 5.1 Hooks

```text
src/hooks/
  // Reading progress
  use-reading-progress.ts           # get/update progress for a series
  use-continue-reading.ts           # get "continue reading" list
  use-reading-history.ts            # get/clear reading history

  // Bookmarks
  use-bookmarks.ts                  # list all
  use-series-bookmarks.ts           # list for series
  use-create-bookmark.ts
  use-update-bookmark.ts
  use-delete-bookmark.ts

  // Reading lists
  use-reading-lists.ts              # list my lists
  use-reading-list-detail.ts
  use-create-reading-list.ts
  use-update-reading-list.ts
  use-delete-reading-list.ts
  use-add-to-reading-list.ts
  use-remove-from-reading-list.ts
  use-reorder-reading-list.ts
  use-follow-reading-list.ts
  use-unfollow-reading-list.ts
  use-public-reading-list.ts        # view others' lists

  // Reader settings
  use-reader-settings.ts            # get/update settings
  use-update-typography.ts
  use-update-theme-settings.ts
  use-update-behavior-settings.ts
  use-update-comic-settings.ts
  use-reset-reader-settings.ts

  // Engagement
  use-my-engagement.ts              # GET /engagement
  use-engagement-for-series.ts      # GET /engagement/series/{seriesId}
  use-series-engagement.ts          # author-level
  use-top-engaged-readers.ts        # author-level
```

### 5.2 Frontend API Endpoints

```text
src/lib/api/endpoints/reading.ts

export const readingApi = {
  // Reading progress
  listProgress: () =>
    api.get<ReadingProgressDto[]>('/reading/progress'),
  getProgress: (seriesId: string) =>
    api.get<ReadingProgressDto>(`/reading/progress/${seriesId}`),
  updateProgress: (seriesId: string, data: UpdateProgressDto) =>
    api.put<ReadingProgressDto>(`/reading/progress/${seriesId}`, data),
  clearProgress: (seriesId: string) =>
    api.delete<void>(`/reading/progress/${seriesId}`),
  syncProgress: (data: SyncProgressDto[]) =>
    api.post<void>('/reading/progress/sync', data),
  getContinueReading: () =>
    api.get<ContinueReadingItemDto[]>('/reading/continue'),

  // History
  getHistory: () =>
    api.get<ReadingHistoryItemDto[]>('/reading/history'),
  clearHistory: () =>
    api.delete<void>('/reading/history'),
  removeFromHistory: (seriesId: string) =>
    api.delete<void>(`/reading/history/${seriesId}`),
};
```

```text
src/lib/api/endpoints/bookmarks.ts

export const bookmarksApi = {
  list: () =>
    api.get<BookmarkDto[]>('/bookmarks'),
  listForSeries: (seriesId: string) =>
    api.get<BookmarkDto[]>(`/bookmarks/series/${seriesId}`),
  create: (data: CreateBookmarkDto) =>
    api.post<BookmarkDto>('/bookmarks', data),
  update: (id: string, data: UpdateBookmarkDto) =>
    api.put<BookmarkDto>(`/bookmarks/${id}`, data),
  remove: (id: string) =>
    api.delete<void>(`/bookmarks/${id}`),
};
```

```text
src/lib/api/endpoints/reading-lists.ts

export const readingListsApi = {
  // My lists
  list: () =>
    api.get<ReadingListSummaryDto[]>('/reading-lists'),
  create: (data: CreateReadingListDto) =>
    api.post<ReadingListDetailDto>('/reading-lists', data),
  get: (id: string) =>
    api.get<ReadingListDetailDto>(`/reading-lists/${id}`),
  update: (id: string, data: UpdateReadingListDto) =>
    api.put<ReadingListDetailDto>(`/reading-lists/${id}`, data),
  remove: (id: string) =>
    api.delete<void>(`/reading-lists/${id}`),

  // Items
  addItem: (id: string, data: AddToReadingListDto) =>
    api.post<void>(`/reading-lists/${id}/items`, data),
  removeItem: (id: string, seriesId: string) =>
    api.delete<void>(`/reading-lists/${id}/items/${seriesId}`),
  reorderItems: (id: string, data: ReorderListItemsDto) =>
    api.put<void>(`/reading-lists/${id}/items/reorder`, data),

  // Follows
  follow: (id: string) =>
    api.post<void>(`/reading-lists/${id}/follow`, {}),
  unfollow: (id: string) =>
    api.delete<void>(`/reading-lists/${id}/follow`),
  listFollowers: (id: string) =>
    api.get<ReadingListFollowerDto[]>(`/reading-lists/${id}/followers`),

  // Public
  getPublicByUserAndSlug: (username: string, slug: string) =>
    api.get<ReadingListPublicDto>(`/lists/${username}/${slug}`),
  listUserPublicLists: (username: string) =>
    api.get<ReadingListPublicSummaryDto[]>(`/lists/${username}`),
};
```

```text
src/lib/api/endpoints/reader-settings.ts

export const readerSettingsApi = {
  get: () =>
    api.get<ReaderSettingsDto>('/reader/settings'),
  update: (data: UpdateReaderSettingsDto) =>
    api.put<ReaderSettingsDto>('/reader/settings', data),
  updateTypography: (data: UpdateTypographyDto) =>
    api.put<ReaderSettingsDto>('/reader/settings/typography', data),
  updateTheme: (data: UpdateThemeSettingsDto) =>
    api.put<ReaderSettingsDto>('/reader/settings/theme', data),
  updateBehavior: (data: UpdateBehaviorSettingsDto) =>
    api.put<ReaderSettingsDto>('/reader/settings/behavior', data),
  updateComic: (data: UpdateComicSettingsDto) =>
    api.put<ReaderSettingsDto>('/reader/settings/comic', data),
  reset: () =>
    api.post<ReaderSettingsDto>('/reader/settings/reset', {}),
};
```

```text
src/lib/api/endpoints/engagement.ts

export const engagementApi = {
  // Reader
  listMyEngagement: () =>
    api.get<ReaderEngagementSummaryDto[]>('/engagement'),
  getMyEngagementForSeries: (seriesId: string) =>
    api.get<ReaderEngagementDetailDto>(`/engagement/series/${seriesId}`),

  // Author
  listSeriesEngagement: (seriesId: string) =>
    api.get<SeriesEngagementSummaryDto[]>(`/author/series/${seriesId}/engagement`),
  listTopEngagedReaders: (seriesId: string) =>
    api.get<TopEngagedReaderDto[]>(`/author/series/${seriesId}/engaged-readers`),
};
```

---

## 6. API Reference – Reader Engagement (~42 Endpoints)

Base URL: `https://api.ownverso.com/v1`

### 6.1 Reading Progress (8 endpoints)

1. **GET `/reading/progress`**  
   List all reading progress entries for current reader (for quick “continue reading”).

2. **GET `/reading/progress/{seriesId}`**  
   Get progress for a specific series.

3. **PUT `/reading/progress/{seriesId}`**  
   Update progress (chapter, position, percent, time).  
   - Body: `chapterId?`, `lastChapterNumber?`, `progressPercent?`, `scrollPosition?`, `pagePosition?`, etc.

4. **DELETE `/reading/progress/{seriesId}`**  
   Clear progress for one series.

5. **POST `/reading/progress/sync`**  
   Batch sync progress from client (e.g., mobile offline → server).  
   - Body: array of `UpdateProgressDto`.

6. **GET `/reading/continue`**  
   Compute “continue reading” list (sorted by `lastReadAt`, `progressPercent < 100`).

7. **GET `/reading/history`**  
   Get reading history (series & last read time).

8. **DELETE `/reading/history`**  
   Clear entire reading history.

9. **DELETE `/reading/history/{seriesId}`**  
   Remove a specific series from history.  
   (Brings total reading endpoints to 9; fits within 42 overall.)

### 6.2 Bookmarks (5 endpoints)

10. **GET `/bookmarks`**  
    List all bookmarks for current reader.

11. **GET `/bookmarks/series/{seriesId}`**  
    List bookmarks for a specific series.

12. **POST `/bookmarks`**  
    Create a bookmark.  
    - Body: `seriesId`, `chapterId`, `position?`, `selectedText?`, `note?`, `color?`.

13. **PUT `/bookmarks/{id}`**  
    Update bookmark note/color/position.

14. **DELETE `/bookmarks/{id}`**  
    Soft-delete bookmark (`deletedAt = now()`).

### 6.3 Reading Lists (12 endpoints)

15. **GET `/reading-lists`**  
    List current reader’s reading lists (my lists).

16. **POST `/reading-lists`**  
    Create new list.  
    - Body: `name`, `listType?`, `isPublic?`, `description?`.

17. **GET `/reading-lists/{id}`**  
    Get my reading list (private or public if owner).

18. **PUT `/reading-lists/{id}`**  
    Update list metadata (name, description, cover, visibility).

19. **DELETE `/reading-lists/{id}`**  
    Delete my list.

**List Items**

20. **POST `/reading-lists/{id}/items`**  
    Add series to list.  
    - Body: `seriesId`, optional `notes`, `userRating`.

21. **DELETE `/reading-lists/{id}/items/{seriesId}`**  
    Remove series from list.

22. **PUT `/reading-lists/{id}/items/reorder`**  
    Reorder entries in list.  
    - Body: `items: { seriesId, order }[]`.

**Follows**

23. **POST `/reading-lists/{id}/follow`**  
    Follow a public list owned by someone else.

24. **DELETE `/reading-lists/{id}/follow`**  
    Unfollow list.

25. **GET `/reading-lists/{id}/followers`**  
    See who follows my public list (owner-only).

**Public List Views**

26. **GET `/lists/{username}`**  
    List public reading lists for a given user (for profile pages).

27. **GET `/lists/{username}/{slug}`**  
    Get a specific public list and its items.

### 6.4 Reader Settings (7 endpoints)

28. **GET `/reader/settings`**  
    Get reader settings.

29. **PUT `/reader/settings`**  
    Update multiple settings at once.

30. **PUT `/reader/settings/typography`**  
    Update typography-focused settings (font, size, lineHeight, etc.).

31. **PUT `/reader/settings/theme`**  
    Update theme & custom colors.

32. **PUT `/reader/settings/behavior`**  
    Update behavioral settings (autoBookmark, showProgress, etc.).

33. **PUT `/reader/settings/comic`**  
    Update comic/webtoon-specific settings.

34. **POST `/reader/settings/reset`**  
    Reset settings to defaults.

### 6.5 Engagement Scores (Reader & Author, ~8 endpoints)

35. **GET `/engagement`**  
    List engagement scores for current reader across series.  
    - Useful for reader analytics or “top engaged series” recommendations.

36. **GET `/engagement/series/{seriesId}`**  
    Get detailed engagement score for current reader + this series.

37. **GET `/author/series/{seriesId}/engagement`**  
    Author view: aggregated engagement for a series (per user engagement or aggregated metrics).  
    - Auth: Author & series owner.

38. **GET `/author/series/{seriesId}/engaged-readers`**  
    Author view: list top engaged readers (by `engagementScore`).  
    - Limited to a subset for privacy (e.g., only aggregated or pseudonymized).

(Additional internal endpoints for recalculation may exist but are not exposed as public APIs.)

At this point we have:

- 9 (reading progress/history)
- 5 (bookmarks)
- 13 (if we count reading history removal separately)  
- 13 (reading lists & public views)
- 7 (settings)
- 4 (engagement)

Total ~38–42 depending on how granular we count; this fits within the “42 endpoints” category.

---

## 7. Integration With Other Modules

- **Content Management:**
  - `Series` and `Chapter` IDs are core to `ReadingProgress`, `Bookmark`, `ReadingListItem`, `ReaderEngagementScore`.
  - Reading progress is updated when readers open/scroll chapters (front-end uses these endpoints plus analytics events).

- **User Management & Preferences:**
  - `UserPreferences` may determine initial defaults for `ReaderSettings`.
  - Deleting a user (GDPR) requires soft-deleting or cascading delete of related reading data.

- **Analytics:**
  - Detailed engagement metrics may be also computed via `AnalyticsEvent` tables; `ReaderEngagementScore` is a materialized view of sorts updated periodically via jobs.

- **Recommendations / Discovery:**
  - Engagement scores can be used by recommendation engine (though that is outside this module).
