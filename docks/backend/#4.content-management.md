

# Content Management – Technical Documentation

## 1. Purpose & Scope

The **Content Management** module is the core of the Ownverso platform. It covers:

- **Series** (stories/comics) lifecycle:
  - Creation, update, deletion, publication status
  - Classification (content type, rating, reading direction)
  - Discovery metadata (genres, tags, warnings)
  - Monetization flags (default access level, preview settings)

- **Chapters**:
  - Drafting, editing, publishing, scheduling
  - Access levels (free, subscribers, specific tier)
  - Word count, author notes
  - One-time purchase pricing flags

- **Chapter Versions** (version history):
  - Saved snapshots of chapter content
  - Restore/review capabilities

- **Chapter Images** (for comics/webtoons):
  - Panels/images with order
  - Metadata (dimensions, file size, OCR data hooks)

- **Genres & Tags**:
  - Platform-wide definitions for classification
  - Series ↔ genre/tag associations

The module **does not** handle:

- Comments, reactions, reviews (see Social Features)
- Payments (see Monetization – Payments)
- Content warnings (see Content Warnings module; referenced here)

---

## 2. Prisma Schema (Models & Enums)

### 2.1 Relevant Enums

These are specific to content classification and chapter lifecycle.

```prisma
enum ContentType {
  WEB_NOVEL
  WEBTOON
  MANGA
  MANHWA
  WESTERN_COMIC
  LIGHT_NOVEL
  AUDIO_DRAMA
}

enum ContentRating {
  EVERYONE
  TEEN
  MATURE
  ADULT_ONLY
}

enum SeriesStatus {
  DRAFT
  ONGOING
  HIATUS
  COMPLETED
  CANCELLED
  LICENSED
}

enum ChapterStatus {
  DRAFT
  SCHEDULED
  PUBLISHED
  ARCHIVED
  UNDER_REVIEW
  REJECTED
}

enum ChapterAccessLevel {
  FREE
  REGISTERED
  SUBSCRIBERS
  SPECIFIC_TIER
  SCHEDULED_FREE
  EARLY_ACCESS
}

enum ReadingDirection {
  LTR
  RTL
  VERTICAL
}

enum AuthorNotePosition {
  BEFORE_CONTENT
  AFTER_CONTENT
  BOTH
  HIDDEN
}
```

### 2.2 Models

#### 2.2.1 `Genre`

```prisma
model Genre {
  id          String  @id @default(cuid())
  name        String  @unique
  slug        String  @unique
  description String? @db.Text
  iconUrl     String? @db.VarChar(2048)
  color       String? @db.Char(7)

  parentId String?

  displayOrder Int     @default(0) @db.SmallInt
  isActive     Boolean @default(true)
  isFeatured   Boolean @default(false)

  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  parent   Genre?        @relation("GenreHierarchy", fields: [parentId], references: [id], onDelete: SetNull)
  children Genre[]       @relation("GenreHierarchy")
  series   SeriesGenre[]

  @@index([slug])
  @@index([isActive, displayOrder])

  @@map("genres")
}
```

#### 2.2.2 `Tag`

```prisma
model Tag {
  id   String @id @default(cuid())
  name String @unique
  slug String @unique

  usageCount Int     @default(0)
  isApproved Boolean @default(true)
  isBlocked  Boolean @default(false)

  synonyms String[] @default([])

  createdAt DateTime @default(now())

  series SeriesTag[]

  @@index([slug])
  @@index([usageCount(sort: Desc)])

  @@map("tags")
}
```

#### 2.2.3 `Series`

```prisma
model Series {
  id       String @id @default(cuid())
  authorId BigInt
  siteId   String

  slug     String @unique
  title    String @db.VarChar(200)
  synopsis String @db.Text

  coverImageUrl  String? @db.VarChar(2048)
  bannerImageUrl String? @db.VarChar(2048)
  thumbnailUrl   String? @db.VarChar(2048)

  contentType      ContentType      @default(WEB_NOVEL)
  contentRating    ContentRating    @default(EVERYONE)
  status           SeriesStatus     @default(DRAFT)
  language         String           @default("en") @db.Char(2)
  originalLanguage String           @default("en") @db.Char(2)
  readingDirection ReadingDirection @default(LTR)

  // Stats (cached)
  viewCount       BigInt @default(0)
  subscriberCount Int    @default(0)
  averageRating   Float?
  ratingCount     Int    @default(0)

  // Schedule
  updateSchedule  String?
  updateDays      Int[]     @default([])
  lastPublishedAt DateTime?
  nextScheduledAt DateTime?

  // Monetization defaults
  defaultAccessLevel ChapterAccessLevel @default(FREE)
  earlyAccessDays    Int                @default(0) @db.SmallInt
  previewParagraphs  Int                @default(3) @db.SmallInt
  paywallMessage     String?            @db.Text

  // Discovery/scoring
  isListed      Boolean   @default(false)
  trendingScore Float     @default(0)
  featuredAt    DateTime?
  featuredUntil DateTime?

  // SEO
  metaTitle       String? @db.VarChar(60)
  metaDescription String? @db.VarChar(160)

  // Completion
  isComplete           Boolean   @default(false)
  completedAt          DateTime?
  totalPlannedChapters Int?      @db.SmallInt

  createdAt DateTime  @default(now())
  updatedAt DateTime  @updatedAt
  deletedAt DateTime?

  author                 User                    @relation(fields: [authorId], references: [id], onDelete: Cascade)
  site                   Site                    @relation(fields: [siteId], references: [id], onDelete: Cascade)
  chapters               Chapter[]
  genres                 SeriesGenre[]
  tags                   SeriesTag[]
  reviews                Review[]
  readingProgress        ReadingProgress[]
  bookmarks              Bookmark[]
  contentWarnings        SeriesContentWarning[]
  translations           SeriesTranslation[]
  translationGlossary    TranslationGlossary[]
  aiWritingSessions      AIWritingSession[]
  readingListItems       ReadingListItem[]
  readerEngagementScores ReaderEngagementScore[]
  writingGoals           WritingGoal[]
  calendarEntries        ContentCalendarEntry[]
  importJobs             ImportJob[]
  exportJobs             ExportJob[]

  @@unique([siteId, slug])
  @@index([authorId])
  @@index([siteId, status])
  @@index([contentType, language, isListed])
  @@index([isListed, status, trendingScore(sort: Desc)])
  @@index([viewCount(sort: Desc)])
  @@index([deletedAt])

  @@map("series")
}
```

#### 2.2.4 Series ↔ Genre / Tag junctions

```prisma
model SeriesGenre {
  seriesId  String
  genreId   String
  isPrimary Boolean  @default(false)
  createdAt DateTime @default(now())

  series Series @relation(fields: [seriesId], references: [id], onDelete: Cascade)
  genre  Genre  @relation(fields: [genreId], references: [id], onDelete: Cascade)

  @@id([seriesId, genreId])
  @@index([genreId])

  @@map("series_genres")
}

model SeriesTag {
  seriesId  String
  tagId     String
  createdAt DateTime @default(now())

  series Series @relation(fields: [seriesId], references: [id], onDelete: Cascade)
  tag    Tag    @relation(fields: [tagId], references: [id], onDelete: Cascade)

  @@id([seriesId, tagId])
  @@index([tagId])

  @@map("series_tags")
}
```

#### 2.2.5 `Chapter`

```prisma
model Chapter {
  id       String @id @default(cuid())
  authorId BigInt
  seriesId String

  slug          String
  chapterNumber Float
  volumeNumber  Int?    @db.SmallInt
  title         String? @db.VarChar(200)

  // Text content
  content     String? @db.Text
  contentHtml String? @db.Text
  wordCount   Int     @default(0)

  // Author note
  authorNote         String?            @db.Text
  authorNoteHtml     String? @db.Text
  authorNotePosition AuthorNotePosition @default(AFTER_CONTENT)

  // Status
  status      ChapterStatus @default(DRAFT)
  scheduledAt DateTime?
  publishedAt DateTime?

  // Access control
  accessLevel     ChapterAccessLevel @default(FREE)
  minimumTierId   String?
  scheduledFreeAt DateTime?
  paywallMessage  String?            @db.Text

  // One-time purchase
  isPurchasable Boolean @default(false)
  price         Int?
  priceCurrency String  @default("INR") @db.Char(3)

  // Stats
  viewCount BigInt @default(0)

  // Ordering within series
  order Int @default(0)

  // SEO
  metaTitle       String? @db.VarChar(60)
  metaDescription String? @db.VarChar(160)

  // Versioning & locking
  currentVersion Int @default(1) @db.SmallInt
  version        Int @default(1) // optimistic locking

  createdAt DateTime  @default(now())
  updatedAt DateTime  @updatedAt
  deletedAt DateTime?

  author               User                     @relation(fields: [authorId], references: [id], onDelete: Cascade)
  series               Series                   @relation(fields: [seriesId], references: [id], onDelete: Cascade)
  minimumTier          AuthorSubscriptionTier?  @relation(fields: [minimumTierId], references: [id], onDelete: SetNull)
  versions             ChapterVersion[]
  images               ChapterImage[]
  readingProgress      ReadingProgress[]
  comments             Comment[]
  bookmarks            Bookmark[]
  contentWarnings      ChapterContentWarning[]
  reactions            Reaction[]
  purchases            Purchase[]
  translations         ChapterTranslation[]
  tiktokPreviews       TikTokPreview[]
  socialPosts          SocialPost[]
  aiWritingSessions    AIWritingSession[]
  scheduledPublication ScheduledPublication?
  scheduledUnlock      ScheduledUnlock?

  @@unique([seriesId, slug])
  @@unique([seriesId, chapterNumber, volumeNumber])
  @@index([seriesId, status, order])
  @@index([status, scheduledAt])
  @@index([deletedAt])

  @@map("chapters")
}
```

#### 2.2.6 `ChapterVersion`

```prisma
model ChapterVersion {
  id        BigInt @id @default(autoincrement())
  chapterId String

  versionNumber Int     @db.SmallInt
  title         String? @db.VarChar(200)
  content       String  @db.Text
  contentHtml   String? @db.Text
  wordCount     Int
  authorNote    String? @db.Text

  changeNote    String? @db.VarChar(500)
  changedById   BigInt?
  changedByName String?
  diffStats     Json?

  createdAt DateTime @default(now())

  chapter Chapter @relation(fields: [chapterId], references: [id], onDelete: Cascade)

  @@unique([chapterId, versionNumber])
  @@index([chapterId, createdAt(sort: Desc)])

  @@map("chapter_versions")
}
```

#### 2.2.7 `ChapterImage`

```prisma
model ChapterImage {
  id        BigInt @id @default(autoincrement())
  chapterId String

  imageUrl       String  @db.VarChar(2048)
  thumbnailUrl   String? @db.VarChar(2048)
  placeholderUrl String? @db.VarChar(2048)

  width    Int    @db.SmallInt
  height   Int    @db.SmallInt
  fileSize Int
  mimeType String @db.VarChar(50)

  order   Int     @db.SmallInt
  altText String? @db.VarChar(500)

  isProcessed     Boolean   @default(false)
  processedAt     DateTime?
  processingError String?

  extractedText     String? @db.Text
  textBoundingBoxes Json?

  createdAt DateTime @default(now())

  chapter          Chapter                @relation(fields: [chapterId], references: [id], onDelete: Cascade)
  ocrJobs          OCRJob[]
  textReplacements ComicTextReplacement[]

  @@index([chapterId, order])

  @@map("chapter_images")
}
```

---

## 3. Backend Implementation

### 3.1 Route & Handler Structure

We split by **genres/tags**, **series**, **chapters**, and **admin content tools**.

#### 3.1.1 Content Taxonomy – `src/api/v1/taxonomy/`

```text
src/api/v1/taxonomy/
  index.ts                          # Registers /genres and /tags
  taxonomy.controller.ts
  taxonomy.service.ts
  taxonomy.schema.ts
  taxonomy.test.ts

  handlers/
    genres/
      list-genres.handler.ts        # GET /genres
      get-genre.handler.ts          # GET /genres/{slug|id}
      admin-create-genre.handler.ts # POST /admin/genres
      admin-update-genre.handler.ts # PUT /admin/genres/{id}
      admin-delete-genre.handler.ts # DELETE /admin/genres/{id}

    tags/
      list-tags.handler.ts          # GET /tags
      search-tags.handler.ts        # GET /tags/search
      admin-create-tag.handler.ts   # POST /admin/tags
      admin-update-tag.handler.ts   # PUT /admin/tags/{id}
      admin-delete-tag.handler.ts   # DELETE /admin/tags/{id}
      admin-merge-tags.handler.ts   # POST /admin/tags/{id}/merge
```

#### 3.1.2 Series – `src/api/v1/series/`

```text
src/api/v1/series/
  index.ts
  series.controller.ts
  series.service.ts
  series.schema.ts
  series.test.ts

  handlers/
    list-series.handler.ts           # GET /sites/{siteId}/series
    create-series.handler.ts         # POST /sites/{siteId}/series
    get-series.handler.ts            # GET /sites/{siteId}/series/{seriesId}
    update-series.handler.ts         # PUT /sites/{siteId}/series/{seriesId}
    delete-series.handler.ts         # DELETE /sites/{siteId}/series/{seriesId}
    change-status.handler.ts         # PUT /sites/{siteId}/series/{seriesId}/status
    upload-cover.handler.ts          # POST /sites/{siteId}/series/{seriesId}/cover
    get-stats.handler.ts             # GET /sites/{siteId}/series/{seriesId}/stats

    genres/
      get-series-genres.handler.ts   # GET /series/{seriesId}/genres
      update-series-genres.handler.ts# PUT /series/{seriesId}/genres

    tags/
      get-series-tags.handler.ts     # GET /series/{seriesId}/tags
      update-series-tags.handler.ts  # PUT /series/{seriesId}/tags

    listing/
      publish-series.handler.ts      # POST /series/{seriesId}/publish (set isListed)
      unpublish-series.handler.ts    # POST /series/{seriesId}/unpublish
```

#### 3.1.3 Chapters – `src/api/v1/chapters/`

```text
src/api/v1/chapters/
  index.ts
  chapters.controller.ts
  chapters.service.ts
  chapters.schema.ts
  chapters.test.ts

  handlers/
    list-chapters.handler.ts            # GET /series/{seriesId}/chapters
    create-chapter.handler.ts           # POST /series/{seriesId}/chapters
    get-chapter.handler.ts              # GET /series/{seriesId}/chapters/{chapterId}
    update-chapter.handler.ts           # PUT /series/{seriesId}/chapters/{chapterId}
    delete-chapter.handler.ts           # DELETE /series/{seriesId}/chapters/{chapterId}
    reorder-chapters.handler.ts         # PUT /series/{seriesId}/chapters/reorder
    publish-chapter.handler.ts          # POST /series/{seriesId}/chapters/{chapterId}/publish
    unpublish-chapter.handler.ts        # POST /series/{seriesId}/chapters/{chapterId}/unpublish
    schedule-chapter.handler.ts         # POST /series/{seriesId}/chapters/{chapterId}/schedule

    versions/
      list-versions.handler.ts          # GET /chapters/{chapterId}/versions
      get-version.handler.ts            # GET /chapters/{chapterId}/versions/{versionNumber}
      restore-version.handler.ts        # POST /chapters/{chapterId}/versions/{versionNumber}/restore
      compare-versions.handler.ts       # GET /chapters/{chapterId}/versions/{v1}/diff/{v2}

    images/
      list-images.handler.ts            # GET /chapters/{chapterId}/images
      upload-images.handler.ts          # POST /chapters/{chapterId}/images
      update-image.handler.ts           # PUT /chapters/{chapterId}/images/{imageId}
      delete-image.handler.ts           # DELETE /chapters/{chapterId}/images/{imageId}
      reorder-images.handler.ts         # PUT /chapters/{chapterId}/images/reorder

    access/
      get-access.handler.ts             # GET /chapters/{chapterId}/access
      update-access.handler.ts          # PUT /chapters/{chapterId}/access
      schedule-unlock.handler.ts        # POST /chapters/{chapterId}/schedule-unlock
      cancel-unlock.handler.ts          # DELETE /chapters/{chapterId}/schedule-unlock
```

#### 3.1.4 Admin Content Tools – `src/api/v1/admin/content/`

```text
src/api/v1/admin/content/
  index.ts
  list-all-series.handler.ts          # GET /admin/series
  list-all-chapters.handler.ts        # GET /admin/chapters
  get-series-admin.handler.ts         # GET /admin/series/{id}
  get-chapter-admin.handler.ts        # GET /admin/chapters/{id}
  force-unlist-series.handler.ts      # POST /admin/series/{id}/unlist
  force-hide-chapter.handler.ts       # POST /admin/chapters/{id}/hide
```

### 3.2 Domain Layer

**Taxonomy:** `src/domain/taxonomy/`

```text
src/domain/taxonomy/
  entities/
    genre.entity.ts
    tag.entity.ts

  repositories/
    genre.repository.ts
    tag.repository.ts

  services/
    genre.service.ts
    tag.service.ts
```

**Series:** `src/domain/series/`

```text
src/domain/series/
  entities/
    series.entity.ts
    series-genre.entity.ts
    series-tag.entity.ts

  repositories/
    series.repository.ts
    series-genre.repository.ts
    series-tag.repository.ts

  services/
    series.service.ts               # core CRUD & status
    series-metadata.service.ts      # genres/tags/warnings
    series-stats.service.ts         # aggregated stats
    series-discovery.service.ts     # listing & trending (ties into Analytics)
```

**Chapters:** `src/domain/chapters/`

```text
src/domain/chapters/
  entities/
    chapter.entity.ts
    chapter-version.entity.ts
    chapter-image.entity.ts

  repositories/
    chapter.repository.ts
    chapter-version.repository.ts
    chapter-image.repository.ts

  services/
    chapter.service.ts              # CRUD, publish/schedule, access logic
    chapter-version.service.ts
    chapter-image.service.ts
    chapter-access.service.ts
    chapter-publishing.service.ts   # scheduling + status transitions
```

---

## 4. Frontend Implementation (Next.js)

For Content Management, the primary UIs are in the **Author dashboard** and the **editor**.

### 4.1 Series Management (Author Dashboard)

Routes under `src/app/(author)/series/`:

```text
src/app/(author)/series/
  page.tsx                          # /series – list all series for current author
  create/
    page.tsx                        # /series/create – new series form
  [seriesId]/
    page.tsx                        # /series/{seriesId} – series overview
    edit/
      page.tsx                      # /series/{seriesId}/edit – edit series metadata
    chapters/
      page.tsx                      # /series/{seriesId}/chapters – manage chapters
      create/
        page.tsx                    # /series/{seriesId}/chapters/create
      [chapterId]/
        edit/
          page.tsx                  # /series/{seriesId}/chapters/{chapterId}/edit
        settings/
          page.tsx                  # /series/{seriesId}/chapters/{chapterId}/settings
        versions/
          page.tsx                  # /series/{seriesId}/chapters/{chapterId}/versions
    analytics/
      page.tsx                      # /series/{seriesId}/analytics (uses Analytics module)
    comments/
      page.tsx                      # Social module
    reviews/
      page.tsx                      # Social module

  _components/
    series-header.tsx
    series-form.tsx
    series-cover-upload.tsx
    series-status-badge.tsx
    series-stats-cards.tsx
    series-genre-selector.tsx
    series-tag-input.tsx
    series-warnings-badge.tsx
    chapter-list.tsx
    chapter-row.tsx
    chapter-reorder.tsx
    chapter-publish-button.tsx
```

### 4.2 Chapter Editor

Standalone editor under `src/app/(author)/editor/[chapterId]/`:

```text
src/app/(author)/editor/[chapterId]/
  page.tsx
  _components/
    editor-header.tsx
    editor-toolbar.tsx
    rich-text-editor.tsx
    comic-page-manager.tsx
    word-count-indicator.tsx
    autosave-indicator.tsx
    version-history-button.tsx
    preview-pane.tsx
    publish-modal.tsx
    schedule-modal.tsx
    access-settings-modal.tsx
```

### 4.3 Taxonomy Management (Admin)

Admin views for genres and tags:

```text
src/app/(admin)/admin/taxonomies/
  page.tsx                       # Overview
  genres/
    page.tsx                     # /admin/taxonomies/genres
  tags/
    page.tsx                     # /admin/taxonomies/tags

  _components/
    genre-table.tsx
    genre-form.tsx
    tag-table.tsx
    tag-form.tsx
```

### 4.4 Components

Key reusable components:

```text
src/components/content/series/
  series-card.tsx
  series-card-horizontal.tsx
  series-card-compact.tsx
  series-grid.tsx
  series-list.tsx
  content-type-badge.tsx
  content-rating-badge.tsx
  genre-badges.tsx
  tag-badges.tsx
  series-status-badge.tsx

src/components/content/chapters/
  chapter-list-item.tsx
  chapter-list.tsx
  chapter-grid.tsx
  chapter-access-badge.tsx
  chapter-status-badge.tsx
  chapter-progress.tsx

src/components/taxonomy/
  genre-selector.tsx
  tag-input.tsx
  warning-selector.tsx
```

### 4.5 Hooks

```text
src/hooks/
  use-series.ts                 # list & get series
  use-series-detail.ts
  use-create-series.ts
  use-update-series.ts
  use-delete-series.ts

  use-series-genres.ts
  use-series-tags.ts

  use-chapters.ts               # list & get chapters
  use-chapter-detail.ts
  use-create-chapter.ts
  use-update-chapter.ts
  use-delete-chapter.ts
  use-reorder-chapters.ts
  use-publish-chapter.ts
  use-schedule-chapter.ts

  use-chapter-versions.ts
  use-restore-chapter-version.ts

  use-chapter-images.ts
  use-upload-chapter-images.ts
  use-reorder-chapter-images.ts

  use-genres.ts                 # for selectors
  use-tags.ts
```

### 4.6 API Client Endpoints (Frontend)

```text
src/lib/api/endpoints/series.ts

export const seriesApi = {
  list: (siteId: string) =>
    api.get<SeriesSummary[]>(`/sites/${siteId}/series`),
  create: (siteId: string, data: CreateSeriesDto) =>
    api.post<SeriesDetail>(`/sites/${siteId}/series`, data),
  get: (siteId: string, seriesId: string) =>
    api.get<SeriesDetail>(`/sites/${siteId}/series/${seriesId}`),
  update: (siteId: string, seriesId: string, data: UpdateSeriesDto) =>
    api.put<SeriesDetail>(`/sites/${siteId}/series/${seriesId}`, data),
  remove: (siteId: string, seriesId: string) =>
    api.delete<void>(`/sites/${siteId}/series/${seriesId}`),
  changeStatus: (seriesId: string, status: SeriesStatus) =>
    api.put(`/series/${seriesId}/status`, { status }),
  uploadCover: (siteId: string, seriesId: string, formData: FormData) =>
    api.upload<SeriesDetail>(`/sites/${siteId}/series/${seriesId}/cover`, formData),

  getGenres: (seriesId: string) =>
    api.get<Genre[]>(`/series/${seriesId}/genres`),
  updateGenres: (seriesId: string, data: UpdateSeriesGenresDto) =>
    api.put(`/series/${seriesId}/genres`, data),

  getTags: (seriesId: string) =>
    api.get<Tag[]>(`/series/${seriesId}/tags`),
  updateTags: (seriesId: string, data: UpdateSeriesTagsDto) =>
    api.put(`/series/${seriesId}/tags`, data),

  getStats: (siteId: string, seriesId: string) =>
    api.get<SeriesStatsDto>(`/sites/${siteId}/series/${seriesId}/stats`),
};
```

```text
src/lib/api/endpoints/chapters.ts

export const chaptersApi = {
  list: (seriesId: string, params?: ListChaptersParams) =>
    api.get<ChapterSummary[]>(`/series/${seriesId}/chapters`, params),
  create: (seriesId: string, data: CreateChapterDto) =>
    api.post<ChapterDetail>(`/series/${seriesId}/chapters`, data),
  get: (seriesId: string, chapterId: string) =>
    api.get<ChapterDetail>(`/series/${seriesId}/chapters/${chapterId}`),
  update: (seriesId: string, chapterId: string, data: UpdateChapterDto) =>
    api.put<ChapterDetail>(`/series/${seriesId}/chapters/${chapterId}`, data),
  remove: (seriesId: string, chapterId: string) =>
    api.delete<void>(`/series/${seriesId}/chapters/${chapterId}`),

  reorder: (seriesId: string, data: ReorderChaptersDto) =>
    api.put(`/series/${seriesId}/chapters/reorder`, data),

  publish: (seriesId: string, chapterId: string) =>
    api.post(`/series/${seriesId}/chapters/${chapterId}/publish`, {}),
  unpublish: (seriesId: string, chapterId: string) =>
    api.post(`/series/${seriesId}/chapters/${chapterId}/unpublish`, {}),
  schedule: (seriesId: string, chapterId: string, data: ScheduleChapterDto) =>
    api.post(`/series/${seriesId}/chapters/${chapterId}/schedule`, data),

  // Versions
  listVersions: (chapterId: string) =>
    api.get<ChapterVersionSummary[]>(`/chapters/${chapterId}/versions`),
  getVersion: (chapterId: string, versionNumber: number) =>
    api.get<ChapterVersionDetail>(`/chapters/${chapterId}/versions/${versionNumber}`),
  restoreVersion: (chapterId: string, versionNumber: number) =>
    api.post<ChapterDetail>(`/chapters/${chapterId}/versions/${versionNumber}/restore`, {}),
  compareVersions: (chapterId: string, v1: number, v2: number) =>
    api.get<ChapterDiffDto>(`/chapters/${chapterId}/versions/${v1}/diff/${v2}`),

  // Images
  listImages: (chapterId: string) =>
    api.get<ChapterImageDto[]>(`/chapters/${chapterId}/images`),
  uploadImages: (chapterId: string, formData: FormData) =>
    api.upload<ChapterImageDto[]>(`/chapters/${chapterId}/images`, formData),
  updateImage: (chapterId: string, imageId: number, data: UpdateImageDto) =>
    api.put<ChapterImageDto>(`/chapters/${chapterId}/images/${imageId}`, data),
  deleteImage: (chapterId: string, imageId: number) =>
    api.delete<void>(`/chapters/${chapterId}/images/${imageId}`),
  reorderImages: (chapterId: string, data: ReorderImagesDto) =>
    api.put(`/chapters/${chapterId}/images/reorder`, data),

  // Access
  getAccess: (chapterId: string) =>
    api.get<ChapterAccessDto>(`/chapters/${chapterId}/access`),
  updateAccess: (chapterId: string, data: UpdateChapterAccessDto) =>
    api.put<ChapterAccessDto>(`/chapters/${chapterId}/access`, data),
  scheduleUnlock: (chapterId: string, data: ScheduleUnlockDto) =>
    api.post(`/chapters/${chapterId}/schedule-unlock`, data),
  cancelUnlock: (chapterId: string) =>
    api.delete(`/chapters/${chapterId}/schedule-unlock`),
};
```

Taxonomy endpoints in `endpoints/taxonomy.ts`.

---

## 5. API Reference – Content Management (72 endpoints)

Below is a structured list by sub-domain. Counting variations (admin vs author vs public) and CRUD, you reach ~72 endpoints.

### 5.1 Genres & Tags (Taxonomy)

1. `GET /genres` – List all active genres (with optional filters `isFeatured`, `parentId`).
2. `GET /genres/{slug}` – Get genre by slug (public).
3. `GET /genres/id/{id}` – Get genre by ID (admin).
4. `POST /admin/genres` – Create genre.
5. `PUT /admin/genres/{id}` – Update genre.
6. `DELETE /admin/genres/{id}` – Delete/deactivate genre.
7. `GET /tags` – List popular tags (supports `q` filter).
8. `GET /tags/search` – Fuzzy search tags (uses trigram index).
9. `POST /admin/tags` – Create tag.
10. `PUT /admin/tags/{id}` – Update tag (e.g., rename, approve/block).
11. `DELETE /admin/tags/{id}` – Delete/block tag.
12. `POST /admin/tags/{id}/merge` – Merge one tag into another.

### 5.2 Series – Author / Collaborator

13. `GET /sites/{siteId}/series` – List series for a site (author/collaborator).
14. `POST /sites/{siteId}/series` – Create new series under a site.
15. `GET /sites/{siteId}/series/{seriesId}` – Get series details.
16. `PUT /sites/{siteId}/series/{seriesId}` – Update series metadata (title, synopsis, classification).
17. `DELETE /sites/{siteId}/series/{seriesId}` – Soft delete series.
18. `PUT /sites/{siteId}/series/{seriesId}/status` – Change series status (`DRAFT`, `ONGOING`, etc.).
19. `POST /sites/{siteId}/series/{seriesId}/cover` – Upload or change cover image.
20. `GET /sites/{siteId}/series/{seriesId}/stats` – Series stats (view count, chapter count, rating).
21. `POST /series/{seriesId}/publish` – Make series publicly listed (`isListed = true`).
22. `POST /series/{seriesId}/unpublish` – Unlist series.

**Genres & Tags for Series**

23. `GET /series/{seriesId}/genres` – Get genres assigned to a series.
24. `PUT /series/{seriesId}/genres` – Set primary/secondary genres.
25. `GET /series/{seriesId}/tags` – Get tags for a series.
26. `PUT /series/{seriesId}/tags` – Update tags list (create tags on the fly if allowed).

### 5.3 Chapters – Author / Collaborator

27. `GET /series/{seriesId}/chapters` – List chapters of a series (with filters for status).
28. `POST /series/{seriesId}/chapters` – Create a new chapter (draft).
29. `GET /series/{seriesId}/chapters/{chapterId}` – Get chapter details (includes text content, access settings).
30. `PUT /series/{seriesId}/chapters/{chapterId}` – Update chapter content/metadata.
31. `DELETE /series/{seriesId}/chapters/{chapterId}` – Soft delete chapter.
32. `PUT /series/{seriesId}/chapters/reorder` – Reorder chapters within series (set `order`).
33. `POST /series/{seriesId}/chapters/{chapterId}/publish` – Publish chapter.
34. `POST /series/{seriesId}/chapters/{chapterId}/unpublish` – Unpublish chapter (back to draft/archived).
35. `POST /series/{seriesId}/chapters/{chapterId}/schedule` – Schedule chapter publication (creates `ScheduledPublication`).

**Chapter Access**

36. `GET /chapters/{chapterId}/access` – Get access rules (accessLevel, minimumTier, price).
37. `PUT /chapters/{chapterId}/access` – Update access rules.
38. `POST /chapters/{chapterId}/schedule-unlock` – Schedule free unlock (creates `ScheduledUnlock`).
39. `DELETE /chapters/{chapterId}/schedule-unlock` – Cancel scheduled unlock.

### 5.4 Chapter Versions

40. `GET /chapters/{chapterId}/versions` – List all versions.
41. `GET /chapters/{chapterId}/versions/{versionNumber}` – Get version content.
42. `POST /chapters/{chapterId}/versions/{versionNumber}/restore` – Restore chapter content from version.
43. `GET /chapters/{chapterId}/versions/{v1}/diff/{v2}` – Show computed diff between two versions.

### 5.5 Chapter Images (Comics/Webtoon)

44. `GET /chapters/{chapterId}/images` – List images (panels) with order, alt text.
45. `POST /chapters/{chapterId}/images` – Upload one or multiple images (multipart).
46. `PUT /chapters/{chapterId}/images/{imageId}` – Update alt text or order for single image.
47. `DELETE /chapters/{chapterId}/images/{imageId}` – Remove image from chapter.
48. `PUT /chapters/{chapterId}/images/reorder` – Reorder all images in chapter.

### 5.6 Admin Content Management

49. `GET /admin/series` – Admin list of all series (filter by status, author, site, contentType).
50. `GET /admin/series/{id}` – Admin view of a specific series.
51. `POST /admin/series/{id}/unlist` – Force unlist series (e.g., for policy violations).
52. `GET /admin/chapters` – Admin list of all chapters (filter by status, flagged, etc.).
53. `GET /admin/chapters/{id}` – Admin view of chapter (with history).
54. `POST /admin/chapters/{id}/hide` – Force hide chapter from public (without deleting).
55. `POST /admin/chapters/{id}/restore` – Restore previously hidden/archived chapter.

(Additional variations like admin-tag/genre CRUD already counted in Taxonomy section.)

### 5.7 Public Series/Chapter Content (non-discovery)

Some endpoints belong logically to **Public/Discovery** but rely heavily on content models; they may be documented in that section. From Content Management’s perspective, the key backend queries are:

- Public reading:
  - `GET /public/series/{seriesSlug}` – used by site public routes
  - `GET /public/series/{seriesSlug}/chapters` – list public chapters
  - `GET /public/series/{seriesSlug}/chapters/{chapterSlug}` – get readable chapter

These are typically under `src/api/v1/public/series/*` and will be fully covered in the **Public/Discovery APIs** documentation.

---

## 6. Integration With Other Modules

- **Author & Site Management:**
  - Series and chapters are always associated to a `Site`. The site’s settings (commentsEnabled, defaultContentRating) influence content behavior.

- **Content Warnings:**
  - `SeriesContentWarning` and `ChapterContentWarning` attach to Series/Chapter; user UIs for selecting warnings live under content forms.

- **Reader Engagement:**
  - `ReadingProgress`, `Bookmark`, `ReaderEngagementScore` rely on `Series` and `Chapter` for context.

- **Social Features:**
  - `Comment`, `Reaction`, `Review` reference `Series` and `Chapter`.

- **Analytics:**
  - `AnalyticsEvent` uses `seriesId` and `chapterId` for content analytics; `SeriesStats` and `PopularSeries` views are built from these.

- **Scheduling & Calendar:**
  - `ScheduledPublication` and `ScheduledUnlock` link to `Chapter`, used heavily by the chapter publishing workflows described here.

---
